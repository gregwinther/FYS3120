\documentclass[11pt]{amsart}

\usepackage[utf8]{inputenc}
\usepackage{amsmath}
\usepackage{physics}

\renewcommand{\thesubsection}{\thesection.\alph{subsection}}

\title[Electrodynamics]{Electrodynamics \\
	\hrulefill \small{ FYS3120: Problem Set 11 } \hrulefill}

\author[Winther-Larsen]{Sebastian G. Winther-Larsen}

\date{\today}

\begin{document}

\maketitle

\section{Simple Lagrangian Dynamics}

A non-relativistic particle, with electric charge $q$ and mass $m$ moves in a magnetic dipole field, given by the vector potential
\begin{equation}
\va{A} = \frac{\mu_0}{4\pi r^3}(\va{\mu} \cp \va{r}),
\end{equation}
where $\va{\mu}$ is the magnetic dipole moment of a static charge distribution centered at the origin.

\subsection{Lagrangian}
The Lagrangian is given by
\begin{equation}
\label{eq:lagrangian1}
L = T + q\va{v} \vdot \va{A}.
\end{equation}
The kinetic energy is simply $T = \frac{1}{2}m\va{v}^2$ while the potential is
\begin{align*}
q\va{v} \vdot \va{A} &= \frac{q\mu_0}{4\pi r^3}\va{v}\vdot(\va{\mu} \cp \va{r}) \\
					 &= \frac{q\mu_0}{4\pi r^3}\va{\mu}\vdot(\va{r}\cp\va{v}) \\
					 &= \frac{q\mu_0}{4\pi m r^3}\va{\mu}\vdot\va{\ell},
\end{align*}
using the cyclic invariance of the vector triple product and $\va{\ell} = m\va{r}\cp\va{v}$. Inserting the parts into \ref{eq:lagrangian1} the Lagrangican becomes
\begin{equation}
\label{eq:lagranrian2}
L = \frac{1}{2}m\va{v}^2 + \frac{q\mu_0}{4\pi m r^3}\va{\mu}\vdot\va{\ell}.
\end{equation}

\subsection{Alternative Lagrangian}
We now make the assumption that the magnetic dipole moment is oriented along the $z$-axis and that the particle moves in the $(x,y)$-plane. In the following, $r = \abs{\va{r}}$ and  the angle $\phi$ between the $x$-axis and the position vector $va{r}$ are chosen as generalised coordinates.

With the magnetic dipole moment oriented along the z-axis, 
\begin{align*}
\va{\mu}\vdot\va{\ell} = \abs{\va{\mu}}\ell_z = \abs{\va{\mu}}(\va{r}\cp\va{p})_z = \abs{\va{\mu}}m(x\dot{y}-y\dot{x}),
\end{align*} 
where $x = r\cos\phi$ and $y = r\sin\phi$. This gives
\begin{align*}
x\dot{y} - y\dot{x} &= r\cos\phi(\dot{r}\sin\phi + r\dot{\phi}\cos\phi) \\
					&- r\sin\phi(\dot{r}\cos\phi - r\dot{\phi}\sin\phi) \\
					&= r^2\phi\cos^2\phi + r^2\phi\sin^2\phi = r^2\phi,
\end{align*} 
similarly
\begin{align*}
\dot{x} &= \dot{r}\cos\phi - r\dot{\phi}\sin\phi \\
\dot{y} &= \dot{r}\sin\phi + r\dot{\phi}\cos\phi \\
\dot{x}^2 &= \dot{r}^2\cos^2\phi - 2r\dot{r}\dot{\phi}\cos\phi\sin\phi + r^2\dot{\phi}^2\sin^2\phi \\
\dot{y}^2 &= \dot{r}^2\sin^2\phi + 2r\dot{r}\dot{\phi}\cos\phi\sin\phi + r^2\dot{\phi}^2\cos^2\phi \\
\dot{v}^2 &= \dot{x}^2 + \dot{y}^2 = \dot{r}^2 + r^2\dot{\phi}^2.
\end{align*}
The Lagrangian with generalised coordinates becomes
\begin{equation}
\label{eq:lagrangian3}
L = \frac{1}{2}m(\dot{r}^2 + \dot{r}^2\dot{\phi}^2) + \frac{q\mu_0}{4\pi mr^3}\abs{\va{\mu}}mr^2\dot{\phi} = \frac{1}{2}m(\dot{r}^2 + \dot{r}^2\dot{\phi}^2) + \lambda\frac{\dot{\phi}}{r},
\end{equation}
where $\lambda \equiv q\mu_0\abs{\va{\mu}}/4\pi$. 

The canonical momentum $p_\phi$ conjugate to $\phi$ becomes
\begin{equation}
\label{eq:conjmomphi}
p_\phi = \frac{\partial L}{\partial \dot{\phi}} = mr^2\dot{\phi} + \frac{\lambda}{r}
\end{equation}
$\phi$ is a cyclic coordinate, because the Lagrangian in equation \ref{eq:lagrangian3} does not explicityly depend on $\phi$. This implies that the conjugate momentum $p_\phi$ is constant. 

The Lagrangian in equation \ref{eq:lagrangian3} does not depend exlicitly on time $t$. This means that the Hamiltonian must be conserved
\begin{equation}
H = \dot{r}p_r + \dot{\phi}p_\phi - L = m\dot{r}^2 + mr^2\dot{\phi}^2 + \lambda\frac{\dot{\phi}}{r} - L = \frac{1}{2}m(\dot{r}^2 + r^2\dot{\phi}^2) = T.
\end{equation}
Since the Hamiltonian equals the kinetic energy and the Hamiltonian is conserved, the kinetic energy is conserved by the magnetic field.

\subsection{Kinetic Energy Conservation}
Lagrange's equation for $r$ is
\begin{equation}
\frac{d}{dt}\left(\frac{\partial L}{\partial \dot{r}}\right) - \frac{\partial L}{\partial r} = \dot{p}_r - \frac{\partial L}{\partial r} = m\ddot{r} - mr\dot{\phi}^2 + \lambda\frac{\dot{\phi}}{r^2} = 0.
\end{equation}
Here one can eliminate $\dot{\phi}$ by inserting $\dot{\phi} = \frac{p_\phi}{mr^2} - \frac{\lambda}{mr^3}$ found from equation \ref{eq:conjmomphi}. This yields
\begin{align*}
& m\ddot{r} - mr\left(\frac{p_\phi}{mr^2} + \frac{\lambda}{mr^3} \right) - \frac{\lambda}{r^2}\left(\frac{p_\phi}{mr^2} - \frac{\lambda}{mr^3}\right) \\
=& m\ddot{r} - mr\left(\frac{p_\phi^2}{m^2r^4} - \frac{2p_\phi\lambda}{m^2r^5} + \frac{\lambda^2}{m^2r^6}\right) + \frac{p_\phi\lambda}{mr^4} - \frac{\lambda^2}{mr^5} \\
=& m\ddot{r} - \frac{p_\phi^2}{mr^3} + \frac{2p_\phi\lambda}{mr^4} - \frac{\lambda^2}{mr^5} + \frac{p_\phi\lambda}{mr^4} - \frac{\lambda^2}{mr^5} = 0
\end{align*}
\begin{equation}
\label{eq:beforersquared}
\rightarrow m\ddot{r} - \frac{p_\phi^2}{mr^3} + \frac{3p_\phi\lambda}{mr^4} - \frac{2\lambda^2}{mr^5} = 0.
\end{equation}
We are interested in the behaviour of $\dot{r}^2$ one can multiply the expression in \ref{eq:beforersquared} with $\dot{r}$. This gives
\begin{equation}
m\ddot{r}\dot{r} = \frac{p_\phi^2}{mr^3}\dot{r} - \frac{3p_\phi\lambda}{mr^4}\dot{r} + \frac{2\lambda^2}{mr^5}\dot{r}
\end{equation}
using $\dot{r}\ddot{r} = \frac{1}{2}\frac{d}{dt}(\dot{r}^2)$ and $\dot{r}dt = \frac{dr}{dt}dt = dr$
\begin{align*}
\frac{1}{2}m\frac{d}{dt}(\dot{r}^2) &= \left(\frac{p_\phi^2}{mr^3} - \frac{3p_\phi\lambda}{mr^4} + \frac{2\lambda^2}{mr^5}\right)\dot{r} \\
d(\dot{r}^2) &= \frac{2}{m}\left(\frac{p_\phi^2}{mr^3} - \frac{3p_\phi\lambda}{mr^4} + \frac{2\lambda^2}{mr^5}\right) dr
\end{align*}
now to integrate from $r_0$ to $r(t)$
\begin{align*}
\dot{r}(t)^2 - \dot{r}(0)^2 &= \frac{2}{m}\int_{r(0)}^{r(t)}\left(\frac{p_\phi^2}{mr^3} - \frac{3p_\phi\lambda}{mr^4} + \frac{2\lambda^2}{mr^5} \right)dr \\
&= -\frac{p_\phi^2}{m^2}(r^{-2} - r_0^{-2}) + \frac{2p_\phi\lambda}{m^2}(r^{-3} - r_o^{-3})\\ &\quad -\frac{\lambda^2}{m^2}(r^{-4}-r_0^{-4}) \\
& = \frac{1}{m^2r_0^2}\left(p_\phi-\frac{\lambda}{r_0}\right)^2 - \frac{1}{m^2r^2}\left(p_\phi - \frac{\lambda}{r}\right)
\end{align*}
from equation \ref{eq:conjmomphi} we have $\dot{\phi}mr^2 = \left(p_\phi-\frac{\lambda}{r}\right)$, inserting in the expression above gives
\begin{equation*}
\dot{r}^2 - \dot{r}_0^2 = r_0^2\dot{\phi}_0^2 - r^2\dot{\phi}^2
\end{equation*}
which can be rearranged to
\begin{equation}
\dot{r}^2 + r^2\dot{\phi}^2 = \dot{r}_0^2 + r_0^2\dot{\phi}_0^2.
\end{equation}
We see again that the kinetic energy is conserved.

\end{document}